<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Users</title>
</head>
<body>

<!-- User table-->
  <h2>User</h2>
  {% if users %}
  <div class="table-wrapper">
      <table class="fl-table">
          <thead>
          <tr>
              <th>User Name</th>
              <th>Access Level</th>
              <th>Full Name</th>
              <th>Role</th>
              <th>Phone</th>
              <th>Email</th>
          </tr>
          </thead>
          <tbody>
            {% for user in users %}
              <tr>
                <td>{{user.usercode}}</td>
                <td>{{user.accesstype}}</td>
                <td>{{user.firstname}} {{user.lastname}}</td>
                <td>{{user.role}}</td>
                <td>{{user.phone}}</td>
                <td>{{user.email}}</td>
              </tr>
            {% endfor %}
          <tbody>
      </table>
  </div>
    {% else %}
    <p>No Active Projects</p>
  {% endif %}

<!-- Projects table-->
  <h2>Projects</h2>
  {% if projects %}
  <div class="table-wrapper">
      <table class="fl-table">
          <thead>
          <tr>
              <th>Project Name</th>
              <th>Project Descrption</th>
              <th>Status</th>
              <th>Start Date</th>
              <th>End Date</th>
              <th>Client</th>
              <th>Project Manager</th>
          </tr>
          </thead>
          <tbody>
            {% for project in projects %}
              <tr>
                <td>
                  <a href="/projects/{{project._id}}">{{project.projectname}}</a>
                </td>
                <td>{{project.description}}</td>
                <td>{{project.Status}}</td>
                <td>{{project.startdate.strftime('%d %b %Y')}}</td>
                <td>{{project.enddate.strftime('%d %b %Y')}}</td>
                <td>
                  <a href="/clients/{{project.clientid}}">{{project.client.clientname}}</a>
                </td>
                <td>
                  <a href="/users/{{project.projectmanagerid}}">{{project.projectmanager.firstname}} {{project.projectmanager.lastname}}</a>
                </td>

              </tr>
            {% endfor %}
          <tbody>
      </table>
  </div>
    {% else %}
    <p>No Active Projects</p>
  {% endif %}

<!-- Project tasks table-->
  <h2>Project Tasks</h2>
  {% if tasks %}
  <div class="table-wrapper">
      <table class="fl-table">
          <thead>
          <tr>
              <th></th>
              <th>Project Name</th>
              <th>Milestone Name</th>
              <th>Task Name</th>
              <th>Task Description</th>
              <th>Due Date</th>
              <th>% Complete</th>
              <th>Contact</th>
          </tr>
          </thead>
          <tbody>
            {% for task in tasks %}
              <tr>
                <td></td>
                <td>
                  <a href="/projects/{{task.projectid}}">{{task.projectname}}</a>
                </td>
                <td>
                  <a href="/projects/{{task.projectid}}/{{task.milestoneid}}">{{task.milestonename}}</a>
                </td>
                <td>
                  <a href="/tasks/{{task._id}}">{{task.taskname}}</a>
                </td>
                <td>{{task.description}}</td>
                <td>{{task.duedate.strftime('%d %b %Y')}}</td>
                <td>{{task.percentagecomplete}}</td>
                {% if 'contact' in task %}
                  <td>{{task.contact.firstname}} {{task.contact.lastname}}</td>
                {% else %}
                  <td></td>
                {% endif %}
              </tr>
            {% endfor %}
          <tbody>
      </table>
  </div>
    {% else %}
    <p>No Project tasks found</p>
  {% endif %}

</body>
</html>